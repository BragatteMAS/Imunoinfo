from functools import reduce

import pandas as pd
import itertools
import glob

def read_file(path):
        df = pd.DataFrame(pd.read_csv(path, index_col=0).unstack(level=0)).T
        df.columns = ['_'.join(combination) for combination in itertools.product(*df.columns.levels)]
        df['name'] = path
        df.set_index('name', drop=True, inplace=True)
        return df
    
final_df = reduce(lambda prev_df, new_df: prev_df.append(read_file(new_df)), 
                  files,
                  pd.DataFrame())
final_df
